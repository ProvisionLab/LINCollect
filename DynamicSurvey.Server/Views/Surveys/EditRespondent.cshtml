@using DynamicSurvey.Server.ViewModels
@model DynamicSurvey.Server.ViewModels.Surveys.EditRespondentViewModel
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@{
    var editSurveyMenuViewModel = new EditSurveyMenuViewModel
    {
        EditSurveyMenu = EditSurveyMenu.AboutRespondent,
        SurveyTemplateId = Model.SurveyTemplateId
    };
}

@{ Html.RenderPartial("_EditSurveyMenu", editSurveyMenuViewModel); }

<input type="hidden" id="questionAction" value="@Model.QuestionAction" />
@if (Model.QuestionAction != null)
{
    Html.RenderPartial("_EditQuestion", Model.EditQuestionViewModel);
}

<div class="portlet light bg-inverse form-fit">
    <div class="portlet-body form">
        <div class="form-horizontal form-bordered form-row-stripped">
            <div class="form-body">
                @foreach (var question in Model.Questions)
                {
                    <div class="row">
                        <div class="col-md-offset-10 col-md-2">
                            <a href="@Url.Action("EditRespondent", "Surveys", new {questionAction = QuestionAction.Add, surveyTemplateId = Model.SurveyTemplateId, insertPosition = question.DisplayOrder})" class="btn btn-sm green">
                                Insert Question
                                <i class="fa fa-plus"></i>
                            </a>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="col-md-1">
                            <span class="label label-primary">@question.DisplayOrder</span>
                        </div>
                        <div class="col-md-8">
                            @Html.Raw(question.Question)
                            @if (question.Format == QuestionFormat.Text)
                            {
                                if (question.Rows == 1)
                                {
                                    <input type="text" class="form-control" />
                                }
                                else
                                {
                                    <textarea class="form-control" rows="@question.Rows"></textarea>
                                }
                            }
                            else if (question.Format == QuestionFormat.ChoiceAcross)
                            {
                                if (question.AllowMultipleValues)
                                {
                                    <div class="checkbox-list">
                                        @foreach (var answerChoice in question.AnswerChoices)
                                        {
                                            <label class="checkbox-inline">
                                                <input type="checkbox" @if (answerChoice.IsDefault) { <text> checked="checked" </text>      } />
                                                @answerChoice.Text
                                            </label>
                                        }
                                    </div>
                                }
                                else
                                {
                                    <div class="radio-list">
                                        @foreach (var answerChoice in question.AnswerChoices)
                                        {
                                            <label class="radio-inline">
                                                <input name="answer-choice-@question.QuestionId" type="radio" @if (answerChoice.IsDefault) { <text> checked="checked" </text>       } />
                                                @answerChoice.Text
                                            </label>
                                        }
                                    </div>
                                }
                            }
                            else if (question.Format == QuestionFormat.ChoiceDown)
                            {
                                if (question.AllowMultipleValues)
                                {
                                    <div class="checkbox-list">
                                        @foreach (var answerChoice in question.AnswerChoices)
                                        {
                                            <label>
                                                <input type="checkbox" @if (answerChoice.IsDefault) { <text> checked="checked" </text>      } />
                                                @answerChoice.Text
                                            </label>
                                        }
                                    </div>
                                }
                                else
                                {
                                    <div class="radio-list">
                                        @foreach (var answerChoice in question.AnswerChoices)
                                        {
                                            <label>
                                                <input name="answer-choice-@question.QuestionId" type="radio" @if (answerChoice.IsDefault) { <text> checked="checked" </text>      } />
                                                @answerChoice.Text
                                            </label>
                                        }
                                    </div>
                                }
                            }
                            else if (question.Format == QuestionFormat.DropDown)
                            {
                                <select class="form-control input-medium">
                                    <option>Select ...</option>
                                    @foreach (var answerChoice in question.AnswerChoices)
                                    {
                                        <option>@answerChoice.Text</option>
                                    }
                                </select>
                            }
                        </div>
                    </div>
                }
                <div class="row">
                    <div class="col-md-offset-10 col-md-2">
                        <a href="@Url.Action("EditRespondent", "Surveys", new {questionAction = QuestionAction.Add, surveyTemplateId = Model.SurveyTemplateId})" class="btn btn-sm green">
                            Insert Question
                            <i class="fa fa-plus"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Plugins
{
    <script src="~/Content/theme/assets/global/plugins/ckeditor/ckeditor.js" type="text/javascript"></script>
    <script src="~/Content/theme/assets/global/plugins/ckeditor/adapters/jquery.js" type="text/javascript"></script>
}

@section Scripts
{
    <script src="~/Scripts/EditRespondent.js" type="text/javascript"></script>
    <script>
        $(document).ready(function () {
            EditRespondent.init();
        });
    </script>
}
